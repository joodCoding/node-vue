(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["productAdd"],{"14d9":function(e,t,r){"use strict";var a=r("23e7"),o=r("7b0b"),c=r("07fa"),l=r("3a34"),n=r("3511"),i=r("d039"),u=i((function(){return 4294967297!==[].push.call({length:4294967296},1)})),s=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(e){return e instanceof TypeError}},d=u||!s();a({target:"Array",proto:!0,arity:1,forced:d},{push:function(e){var t=o(this),r=c(t),a=arguments.length;n(r+a);for(var i=0;i<a;i++)t[r]=arguments[i],r++;return l(t,r),r}})},"271a":function(e,t,r){"use strict";var a=r("cb2d"),o=r("e330"),c=r("577e"),l=r("d6d6"),n=URLSearchParams,i=n.prototype,u=o(i.getAll),s=o(i.has),d=new n("a=1");!d.has("a",2)&&d.has("a",void 0)||a(i,"has",(function(e){var t=arguments.length,r=t<2?void 0:arguments[1];if(t&&void 0===r)return s(this,e);var a=u(this,e);l(t,1);var o=c(r),n=0;while(n<a.length)if(a[n++]===o)return!0;return!1}),{enumerable:!0,unsafe:!0})},3511:function(e,t,r){"use strict";var a=TypeError,o=9007199254740991;e.exports=function(e){if(e>o)throw a("Maximum allowed index exceeded");return e}},"3a34":function(e,t,r){"use strict";var a=r("83ab"),o=r("e8b5"),c=TypeError,l=Object.getOwnPropertyDescriptor,n=a&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}();e.exports=n?function(e,t){if(o(e)&&!l(e,"length").writable)throw new c("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t}},5220:function(e,t,r){"use strict";r.r(t);r("14d9"),r("88a7"),r("271a"),r("5494");var a=r("7a23"),o=r("6605"),c=r("b775"),l=r("3ef4"),n=r("f6f2");const i={class:"shop-management-container"},u={class:"card-header"},s=["src"],d=["src"];var b={__name:"ProductAdd",setup(e){const t=Object(o["d"])(),r=Object(o["c"])().params.id,b=Object(a["ref"])({productId:"",name:"",price:0,oldPrice:0,tabs:[],img:null,rawImgFile:""}),p=Object(a["ref"])([]),m={name:[{required:!0,message:"请输入产品名称",trigger:"blur"}],price:[{required:!0,message:"请输入价格",trigger:"blur"}],oldPrice:[{required:!0,message:"请输入原价",trigger:"blur"}],tabs:[{type:"array",required:!0,message:"请选择产品标签",trigger:"change"}],img:[{required:!0,message:"请上传产品图片",trigger:"change"}]};Object(a["onMounted"])(async()=>{try{const e=await Object(c["b"])("api/shop/"+r);0===(null===e||void 0===e?void 0:e.errno)&&null!==e&&void 0!==e&&e.data&&(p.value=e.data.tabs,0===p.value.length&&(console.log("test"),t.push({path:"/shop/tag/manager/"+r})))}catch(e){l["a"].error(e.message||"获取店铺信息失败")}});const h=e=>{b.value.img=e,b.value.rawImgFile=URL.createObjectURL(e.raw)},f=e=>{const t=e.type.startsWith("image/");return t||l["a"].error("只能上传图片文件!"),t},v=async()=>{try{console.log(b.value);const e=await Object(c["d"])(`/api/shop/${r}/product`,b.value,!0);0===e.errno?(l["a"].success("产品信息更新成功"),b.value={productId:"",name:"",price:0,oldPrice:null,tabs:[],img:null,rawImgFile:""}):l["a"].error("产品创建失败")}catch(e){l["a"].error(e.message||"产品更新失败")}},O=()=>{t.back()};return(e,t)=>{const r=Object(a["resolveComponent"])("el-button"),o=Object(a["resolveComponent"])("el-input"),c=Object(a["resolveComponent"])("el-form-item"),l=Object(a["resolveComponent"])("el-input-number"),j=Object(a["resolveComponent"])("el-checkbox"),g=Object(a["resolveComponent"])("el-checkbox-group"),w=Object(a["resolveComponent"])("el-icon"),y=Object(a["resolveComponent"])("el-upload"),V=Object(a["resolveComponent"])("el-form"),k=Object(a["resolveComponent"])("el-card");return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",i,[Object(a["createVNode"])(k,{class:"box-card"},{default:Object(a["withCtx"])(()=>[Object(a["createElementVNode"])("div",u,[t[5]||(t[5]=Object(a["createElementVNode"])("span",null,"新增产品",-1)),Object(a["createVNode"])(r,{onClick:O},{default:Object(a["withCtx"])(()=>t[4]||(t[4]=[Object(a["createTextVNode"])("返回")])),_:1,__:[4]})]),Object(a["createVNode"])(V,{ref:"productFormRef",model:b.value,rules:m,onSubmit:Object(a["withModifiers"])(v,["prevent"]),class:"product-form"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(c,{label:"产品名称",prop:"name"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(o,{modelValue:b.value.name,"onUpdate:modelValue":t[0]||(t[0]=e=>b.value.name=e),placeholder:"请输入产品名称"},null,8,["modelValue"])]),_:1}),Object(a["createVNode"])(c,{label:"价格",prop:"price"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(l,{modelValue:b.value.price,"onUpdate:modelValue":t[1]||(t[1]=e=>b.value.price=e),min:0,precision:2,"controls-position":"right"},null,8,["modelValue"])]),_:1}),Object(a["createVNode"])(c,{label:"原价",prop:"oldPrice"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(l,{modelValue:b.value.oldPrice,"onUpdate:modelValue":t[2]||(t[2]=e=>b.value.oldPrice=e),min:0,precision:2,"controls-position":"right"},null,8,["modelValue"])]),_:1}),Object(a["createVNode"])(c,{label:"产品标签",prop:"tabs"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(g,{modelValue:b.value.tabs,"onUpdate:modelValue":t[3]||(t[3]=e=>b.value.tabs=e)},{default:Object(a["withCtx"])(()=>[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(p.value,e=>(Object(a["openBlock"])(),Object(a["createBlock"])(j,{key:e.name,label:e.tab},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.name),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),Object(a["createVNode"])(c,{label:"产品图片",prop:"img"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(y,{"on-change":h,"before-upload":f,"show-file-list":!1,"auto-upload":!1,class:"avatar-uploader"},{default:Object(a["withCtx"])(()=>[b.value.img&&"string"===typeof b.value.img?(Object(a["openBlock"])(),Object(a["createElementBlock"])("img",{key:0,src:b.value.img,class:"avatar"},null,8,s)):Object(a["createCommentVNode"])("",!0),b.value.rawImgFile&&"string"===typeof b.value.rawImgFile?(Object(a["openBlock"])(),Object(a["createElementBlock"])("img",{key:1,src:b.value.rawImgFile,class:"avatar"},null,8,d)):(Object(a["openBlock"])(),Object(a["createBlock"])(w,{key:2,class:"avatar-uploader-icon"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(Object(a["unref"])(n["Plus"]))]),_:1}))]),_:1}),t[6]||(t[6]=Object(a["createElementVNode"])("div",{class:"el-upload__tip"},"只能上传图片文件，建议尺寸1:1",-1))]),_:1,__:[6]}),Object(a["createVNode"])(c,null,{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(r,{type:"primary","native-type":"submit",class:"submit-button"},{default:Object(a["withCtx"])(()=>t[7]||(t[7]=[Object(a["createTextVNode"])("保存产品修改")])),_:1,__:[7]})]),_:1})]),_:1},8,["model"])]),_:1})])}}},p=(r("8bf4"),r("6b0d")),m=r.n(p);const h=m()(b,[["__scopeId","data-v-fdf1b478"]]);t["default"]=h},5494:function(e,t,r){"use strict";var a=r("83ab"),o=r("e330"),c=r("edd0"),l=URLSearchParams.prototype,n=o(l.forEach);a&&!("size"in l)&&c(l,"size",{get:function(){var e=0;return n(this,(function(){e++})),e},configurable:!0,enumerable:!0})},"84e3":function(e,t,r){},"88a7":function(e,t,r){"use strict";var a=r("cb2d"),o=r("e330"),c=r("577e"),l=r("d6d6"),n=URLSearchParams,i=n.prototype,u=o(i.append),s=o(i["delete"]),d=o(i.forEach),b=o([].push),p=new n("a=1&a=2&b=3");p["delete"]("a",1),p["delete"]("b",void 0),p+""!=="a=2"&&a(i,"delete",(function(e){var t=arguments.length,r=t<2?void 0:arguments[1];if(t&&void 0===r)return s(this,e);var a=[];d(this,(function(e,t){b(a,{key:t,value:e})})),l(t,1);var o,n=c(e),i=c(r),p=0,m=0,h=!1,f=a.length;while(p<f)o=a[p++],h||o.key===n?(h=!0,s(this,o.key)):m++;while(m<f)o=a[m++],o.key===n&&o.value===i||u(this,o.key,o.value)}),{enumerable:!0,unsafe:!0})},"8bf4":function(e,t,r){"use strict";r("84e3")},d6d6:function(e,t,r){"use strict";var a=TypeError;e.exports=function(e,t){if(e<t)throw new a("Not enough arguments");return e}},e8b5:function(e,t,r){"use strict";var a=r("c6b6");e.exports=Array.isArray||function(e){return"Array"===a(e)}}}]);
//# sourceMappingURL=productAdd.2824f40c.js.map